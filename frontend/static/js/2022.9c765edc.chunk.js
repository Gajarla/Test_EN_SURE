(self.webpackChunk_minimal_minimal_kit_react=self.webpackChunk_minimal_minimal_kit_react||[]).push([[2022],{2990:(e,t,i)=>{"use strict";i.d(t,{nZ:()=>H,jM:()=>T,_H:()=>F});var n=i(53536),s=i(5748),l=i(89488),o=i(51875),r=i(20901),a=i(23546),d=i(54119),c=i(34535),u=i(90310),p=i(63336),x=i(96446),h=i(85865),v=i(35721),m=i(37918),j=i(2050),f=i(48734),A=i(8266),g=i(67784),y=i(88911),b=i(42518),w=i(73338),S=i(76412),C=i(61882),k=i(99522),D=i(70579);const N=(0,c.Ay)("div")(e=>{let{theme:t}=e;return{outline:"none",display:"flex",textAlign:"center",alignItems:"center",flexDirection:"column",justifyContent:"center",padding:t.spacing(5,1),borderRadius:t.shape.borderRadius,backgroundColor:t.palette.background.neutral,border:`1px dashed ${t.palette.grey[50032]}`,"&:hover":{opacity:.72,cursor:"pointer"},[t.breakpoints.up("md")]:{textAlign:"left",flexDirection:"row"}}});function T(e){let{error:t,showPreview:i=!0,files:c,onRemove:T,onRemoveAll:I,sx:E,...O}=e;const R=(null===c||void 0===c?void 0:c.length)>0,{getRootProps:P,getInputProps:$,isDragActive:_,isDragReject:M,fileRejections:U}=(0,l.VB)({multiple:!0,...O}),L="image/*"===(null===O||void 0===O?void 0:O.accept),F=()=>(0,D.jsx)(p.A,{variant:"outlined",sx:{py:1,px:2,mt:3,borderColor:"error.light",bgcolor:e=>(0,u.X4)(e.palette.error.main,.08)},children:U.map(e=>{let{file:t,errors:i}=e;const{path:n,size:s}=t;return(0,D.jsxs)(x.A,{sx:{my:1},children:[(0,D.jsxs)(h.A,{variant:"subtitle2",noWrap:!0,children:[n," - ",(0,w.tm)(s)]}),i.map(e=>(0,D.jsxs)(h.A,{variant:"caption",component:"p",children:["- ",e.message]},e.code))]},n)})});return(0,D.jsxs)(x.A,{sx:{width:"100%",...E},children:[(0,D.jsxs)(N,{...P(),sx:{..._&&{opacity:.72},...(M||t)&&{color:"error.main",borderColor:"error.light",bgcolor:"error.lighter"}},children:[(0,D.jsx)("input",{...$()}),(0,D.jsx)(k.E4,{sx:{width:220}}),(0,D.jsxs)(x.A,{sx:{p:3,ml:{md:2}},children:[(0,D.jsx)(h.A,{gutterBottom:!0,variant:"h5",children:"Drop or Select file"}),(0,D.jsxs)(h.A,{variant:"body2",sx:{color:"text.secondary"},children:["Drop files here or click\xa0",(0,D.jsx)(h.A,{variant:"body2",component:"span",sx:{color:"primary.main",textDecoration:"underline"},children:"browse"}),"\xa0through your machine"]}),L&&(0,D.jsx)(h.A,{variant:"body2",sx:{color:"text.secondary"},children:"Only image files are allowed."})]})]}),U.length>0&&(0,D.jsx)(F,{}),(0,D.jsx)(v.A,{disablePadding:!0,sx:{...R&&{my:3}},children:(0,D.jsx)(a.N,{children:null===c||void 0===c?void 0:c.map(e=>{const{name:t,size:l,preview:a}=e,c=(0,n.isString)(e)?e:t;return i?(0,D.jsxs)(m.Ay,{component:d.P.div,...C.xB,sx:{p:0,m:.5,width:80,height:80,borderRadius:1.5,overflow:"hidden",position:"relative",display:"inline-flex"},children:[(0,D.jsx)(p.A,{variant:"outlined",component:"img",src:(0,n.isString)(e)?e:a,sx:{width:"100%",height:"100%",objectFit:"cover",position:"absolute"}}),(0,D.jsx)(x.A,{sx:{top:6,right:6,position:"absolute"},children:(0,D.jsx)(S.ZM,{size:"small",onClick:()=>T(e),sx:{p:"2px",color:"common.white",bgcolor:e=>(0,u.X4)(e.palette.grey[900],.72),"&:hover":{bgcolor:e=>(0,u.X4)(e.palette.grey[900],.48)}},children:(0,D.jsx)(s.In,{icon:r.A})})})]},c):(0,D.jsxs)(m.Ay,{component:d.P.div,...C.xB,sx:{my:1,py:.75,px:2,borderRadius:1,border:e=>`solid 1px ${e.palette.divider}`,bgcolor:"background.paper"},children:[(0,D.jsx)(j.A,{children:(0,D.jsx)(s.In,{icon:o.A,width:28,height:28})}),(0,D.jsx)(f.A,{primary:(0,n.isString)(e)?e:t,secondary:(0,n.isString)(e)?"":(0,w.tm)(l),primaryTypographyProps:{variant:"subtitle2"},secondaryTypographyProps:{variant:"caption"}}),(0,D.jsx)(A.A,{children:(0,D.jsx)(S.ZM,{edge:"end",size:"small",onClick:()=>T(e),children:(0,D.jsx)(s.In,{icon:r.A})})})]},c)})})}),R&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(g.A,{id:"standard-helperText",label:`${null===c||void 0===c?void 0:c.length} files selected`,variant:"standard",disabled:!0,border:"none",sx:{"& fieldset":{border:"none"}}}),(0,D.jsxs)(y.A,{direction:"row",justifyContent:"flex-end",children:[(0,D.jsx)(b.A,{onClick:I,sx:{mr:1.5},children:"Remove all"}),(0,D.jsx)(b.A,{variant:"contained",sx:{display:"none"},children:"Upload files"})]})]})]})}var I=i(83462),E=i(35316),O=i(98533),R=i(29347),P=i(65043),$=i(33211),_=i(60949);const M=(0,c.Ay)("div")(e=>{let{theme:t}=e;return{outline:"none",overflow:"hidden",textAlign:"center",position:"relative",alignItems:"center",flexDirection:"column",justifyContent:"center",padding:t.spacing(0,0),borderRadius:t.shape.borderRadius,transition:t.transitions.create("padding"),backgroundColor:"#edf6fc",boxShadow:"0 0 1px #32749e",opacity:.85,"&:hover":{opacity:1,cursor:"pointer"},[t.breakpoints.up("md")]:{textAlign:"left",flexDirection:"row"}}}),U=(0,c.Ay)("div")(()=>({textAlign:"center",textDecoration:"underline",color:"#fff"})),L=(0,c.Ay)("div")(()=>({display:"flex"}));function F(e){let{error:t,isEdit:i,onDelete:n,onReplace:s,fileType:o,filePath:r,fileName:a,moduleID:d,file:c,sx:u,...p}=e;const[v,m]=(0,P.useState)(!1),{getRootProps:j,getInputProps:f,isDragActive:A,isDragReject:g}=(0,l.VB)({multiple:!1,accept:p.accept,onDrop:p.onDrop}),y=()=>{m(!1)};return(0,D.jsxs)(x.A,{sx:{...u,width:"100%",height:"150px"},children:[(0,D.jsxs)(M,{...j(),sx:{...A&&{opacity:.72},...(g||t)&&{color:"error.main",borderColor:"error.light",bgcolor:"error.lighter"}},children:[!c&&i&&(0,D.jsx)(U,{onClick:e=>{e.stopPropagation(),(async()=>{let e=null;try{if(e=await $.A.get(`${_.A.host}/api/projects/downloadModule/${d}/${o}/`,{responseType:"blob"}),e){const t=new Blob([e.data]),i=document.createElement("a");i.href=window.URL.createObjectURL(t),i.download=r,i.click()}}catch(t){console.log(e.data)}})()},children:(0,D.jsx)("span",{children:r})}),(0,D.jsxs)(L,{children:[(0,D.jsx)("input",{...f()}),(0,D.jsx)(k.E4,{sx:{marginLeft:"10px",height:"120px",width:"120px"}}),(0,D.jsx)(x.A,{sx:{p:2,ml:{md:2},paddingLeft:"0px",width:"100%",height:"140px",display:"flex",alignItems:"center",justifyContent:"center"},children:c||a?(0,D.jsxs)("div",{style:{width:"100%",padding:"10px 0px 0px 0px",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,D.jsx)("filePath",{children:(null===c||void 0===c?void 0:c.name)||a}),(0,D.jsxs)("div",{style:{paddingTop:"20px",width:"150px",display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[(0,D.jsx)(b.A,{sx:{backgroundColor:"#32749e",height:"28px",padding:"5px 10px",color:"#fff"},onClick:e=>{e.stopPropagation(),s()},children:"Replace"}),null!==c&&void 0!==c&&c.name||a?(0,D.jsx)(b.A,{sx:{backgroundColor:"#32749e",height:"28px",padding:"5px 10px",color:"#fff"},onClick:e=>{e.stopPropagation(),m(!0)},children:"Delete"}):null]})]}):(0,D.jsxs)(h.A,{variant:"body2",sx:{color:"#000",fontSize:"16px",fontWeight:"bold"},children:["Drop files here OR click\xa0",(0,D.jsx)(h.A,{variant:"body2",component:"span",sx:{color:"#000",fontWeight:"bold",textDecoration:"underline"},children:"Browse"})]})})]})]}),(0,D.jsxs)(I.A,{open:v,onClose:y,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,D.jsx)(E.A,{children:(0,D.jsxs)(O.A,{id:"alert-dialog-description",children:[(0,D.jsx)("br",{}),"Are you sure want to delete this file ?"]})}),(0,D.jsxs)(R.A,{children:[(0,D.jsx)(b.A,{onClick:()=>{n(),m(!1)},children:"Yes"}),(0,D.jsx)(b.A,{onClick:y,children:"No"})]})]})]})}var B=i(45518);const W=(0,c.Ay)("div")(e=>{let{theme:t}=e;return{width:144,height:144,margin:"auto",borderRadius:"50%",padding:t.spacing(1),border:`1px dashed ${t.palette.grey[50032]}`}}),z=(0,c.Ay)("div")({zIndex:0,width:"100%",height:"100%",outline:"none",display:"flex",overflow:"hidden",borderRadius:"50%",position:"relative",alignItems:"center",justifyContent:"center","& > *":{width:"100%",height:"100%"},"&:hover":{cursor:"pointer","& .placeholder":{zIndex:9}}}),V=(0,c.Ay)("div")(e=>{var t;let{theme:i}=e;return{display:"flex",position:"absolute",alignItems:"center",flexDirection:"column",justifyContent:"center",color:null===(t=i.palette)||void 0===t?void 0:t.text.secondary,backgroundColor:i.palette.background.neutral,transition:i.transitions.create("opacity",{easing:i.transitions.easing.easeInOut,duration:i.transitions.duration.shorter}),"&:hover":{opacity:.72}}});function H(e){let{error:t,file:i,caption:o,sx:r,...a}=e;const{getRootProps:d,getInputProps:c,isDragActive:v,isDragReject:m,fileRejections:j}=(0,l.VB)({multiple:!1,...a}),f=()=>(0,D.jsx)(p.A,{variant:"outlined",sx:{py:1,px:2,my:2,borderColor:"error.light",bgcolor:e=>(0,u.X4)(e.palette.error.main,.08)},children:j.map(e=>{let{file:t,errors:i}=e;const{path:n,size:s}=t;return(0,D.jsxs)(x.A,{sx:{my:1},children:[(0,D.jsxs)(h.A,{variant:"subtitle2",noWrap:!0,children:[n," - ",(0,w.tm)(s)]}),i.map(e=>(0,D.jsxs)(h.A,{variant:"caption",component:"p",children:["- ",e.message]},e.code))]},n)})});return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(W,{sx:r,children:(0,D.jsxs)(z,{...d(),sx:{...v&&{opacity:.72},...(m||t)&&{color:"error.main",borderColor:"error.light",bgcolor:"error.lighter"}},children:[(0,D.jsx)("input",{...c()}),i&&(0,D.jsx)(x.A,{component:"img",alt:"avatar",src:(0,n.isString)(i)?i:i.preview,sx:{zIndex:8,objectFit:"cover"}}),(0,D.jsxs)(V,{className:"placeholder",sx:{...i&&{opacity:0,color:"common.white",bgcolor:"grey.900","&:hover":{opacity:.72}}},children:[(0,D.jsx)(x.A,{component:s.In,icon:B.A,sx:{width:24,height:24,mb:1}}),(0,D.jsx)(h.A,{variant:"caption",children:i?"Update photo":"Upload photo"})]})]})}),o,j.length>0&&(0,D.jsx)(f,{})]})}},36880:(e,t,i)=>{"use strict";i.d(t,{A:()=>x});var n=i(53536),s=i(5748),l=i(11892),o=i(96446),r=i(85865),a=i(77739),d=i(17392),c=i(88446),u=i(76412),p=i(70579);function x(e){let{links:t,action:i,heading:x,info:h,moreLink:v=[],sx:m,...j}=e;return(0,p.jsxs)(o.A,{sx:{mb:5,...m},children:[(0,p.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,p.jsxs)(o.A,{sx:{flexGrow:1},children:[(0,p.jsxs)(o.A,{sx:{display:"flex",alignItems:"flex-start"},children:[(0,p.jsx)(r.A,{variant:"h4",gutterBottom:!0,children:x}),(0,p.jsx)(a.A,{title:h,placement:"bottom",arrow:!0,children:(0,p.jsx)(d.A,{children:(0,p.jsx)(s.In,{icon:l.A,width:25,height:25})})})]}),(0,p.jsx)(u._5,{links:t,...j})]}),i&&(0,p.jsx)(o.A,{sx:{flexShrink:0},children:i})]}),(0,p.jsx)(o.A,{sx:{mt:2},children:(0,n.isString)(v)?(0,p.jsx)(c.A,{href:v,target:"_blank",variant:"body2",children:v}):v.map(e=>(0,p.jsx)(c.A,{noWrap:!0,href:e,variant:"body2",target:"_blank",sx:{display:"table"},children:e},e))})]})}},73338:(e,t,i)=>{"use strict";i.d(t,{IG:()=>o,Rn:()=>a,kB:()=>r,pA:()=>c,tm:()=>d});var n=i(53536),s=i(79328),l=i.n(s);function o(e){return l()(e/100).format("0.0%")}function r(e){return l()(e).format()}function a(e){return(0,n.replace)(l()(e).format("0.00a"),".00","")}function d(e){return l()(e).format("0.0 b")}function c(e,t){return l()(e/t).format("0.0%")}},83686:()=>{},86687:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>Z});var n=i(65043),s=i(73216),l=i(19252),o=i(15285),r=i(48407),a=i(11737),d=i(96221),c=i(36880),u=i(80899),p=i(46987),x=i(86897),h=i(11238),v=(i(5748),i(85405),i(72812)),m=i(68903),j=i(12110),f=i(88911),A=i(85865),g=i(67784),y=i(79958),b=i(79650),w=i(71806),S=i(84882),C=i(28076),k=i(10039),D=i(73460),N=i(96446),T=i(83462),I=i(26600),E=i(35316),O=i(98533),R=i(29347),P=i(42518);const $=i.p+"static/media/SampleTemplate.6e8132d00f897e7ecd7c.xlsx";var _=i(69092),M=i(2990),U=i(42033),L=i(8525),F=i(26870),B=i(77137),W=i(70579);let z=[];const V=[{value:"manual",label:"Manual"},{value:"automated",label:"Automated"}],H={JSON:"JSON",TEST_DATA:"TEST_DATA",MANUAL:"MANUAL"},J={"application/json":[".json"]},q={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/octet-stream":[".xls",".xlsx"]};function X(e){var t,i,l,a;let{isEdit:d,currentModule:c}=e;const X=(0,s.Zp)(),{enqueueSnackbar:Y}=(0,p.dh)(),Z=(0,o.wA)(),{currentUser:G,appendUrl:Q}=(0,o.d4)(e=>e.user),{currentProject:K}=(0,o.d4)(e=>e.project),{jsonData:ee,moduleList:te,validations:ie}=(0,o.d4)(e=>e.module),[ne,se]=(0,n.useState)(!1),[le,oe]=(0,n.useState)(null),[re,ae]=(0,n.useState)(""),[de,ce]=(0,n.useState)(null),[ue,pe]=(0,n.useState)(""),[xe,he]=(0,n.useState)(""),[ve,me]=(0,n.useState)([]),[je,fe]=(0,n.useState)(),[Ae,ge]=(0,n.useState)(!0),[ye,be]=(0,n.useState)(),[we,Se]=(0,n.useState)("automated"),[Ce,ke]=(0,n.useState)(!1),[De,Ne]=(0,n.useState)(!1),[Te,Ie]=(0,n.useState)({}),[Ee,Oe]=(0,n.useState)(),[Re,Pe]=(0,n.useState)(),[$e,_e]=(0,n.useState)(),[Me,Ue]=(0,n.useState)(!0),[Le,Fe]=(0,n.useState)(!1),Be=e=>{X((e=>{let t=e;return Q&&(t=`${e}?${Q}`),t})(e))},We=()=>{ke(!1)},ze=u.Ik().shape({}),Ve=async()=>{try{const e=localStorage.getItem("accessToken"),t={...G};delete t.avatarUrl,delete t.createdAt,delete t.defecttrack,delete t.projectsRoles,delete t.createdBy,delete t.isSSO,delete t.updatedAt,delete t.updatedBy;const i=`testensure://open?user=${encodeURIComponent(btoa(JSON.stringify(t)))}&userId=${G._id}&projectId=${null===K||void 0===K?void 0:K._id}&token=${e}`,n=`http://192.168.1.53:5000/api/releases/v1/download/${null===G||void 0===G?void 0:G._id}/TestEnsure%20Studio.zip?bypass=true`;console.log("\ud83d\udd17 Trying to open app with URL:",i),console.log("\u2b07\ufe0f Fallback download URL:",n);const s=document.createElement("iframe");s.style.display="none",s.src=i,document.body.appendChild(s),setTimeout(()=>{s&&s.parentNode&&s.parentNode.removeChild(s);if(window.confirm('Did the TestEnsure JSON Builder app open successfully? Click "Cancel" to download it.'))console.log("\u2705 User confirmed the app opened. No download needed.");else{const e=document.createElement("a");e.href=n,e.download="",document.body.appendChild(e),e.click(),document.body.removeChild(e)}},5e3)}catch(e){console.error("\ud83d\udca5 Error while trying to open app or download file:",e)}},He=(0,n.useCallback)(e=>{let t=0,i=0,n=[];if(e&&"testCases"in e){const{testCases:s}=e;Array.isArray(s)&&(t=s.length,s.forEach(e=>{const t=e.testNode?e.testNode:e;if("testCaseSteps"in t){const{testCaseSteps:e,tags:s}=t;s&&n.push(...s),e&&Array.isArray(e)&&(i+=e.length)}t.automationStatus=!0}))}n=[...new Set(n)],e&&(e.testCasesCount=t,e.testStepsCount=i,(0,L.fD)(Z,e))},[Z]),Je=(0,n.useCallback)(()=>{he(""),me([]),oe(null),ae(null),ge(!0),(0,L.fD)(Z,null),Fe(!1),Ue(!0),z=[]},[Z]);function qe(e){function t(i,n){return!!e[i]&&(!!n.has(i)||(n.add(i),t(e[i],n)))}const i=new Set;return Object.keys(e).forEach(e=>{t(e,new Set)&&i.add(e)}),Array.from(i)}function Xe(e){const t=["th","st","nd","rd"],i=e%100;return e+(t[(i-20)%10]||t[i]||t[0])}const Ye=(0,n.useCallback)(async(e,t)=>{try{if(0===t.length){const t=[];he(""),me(t);const i=e[0];if(i){oe({...i,preview:URL.createObjectURL(i)});const n=i.name;if(ae(n),n.includes(".json")||n.includes(".xls")||n.includes(".xlsx")){const s=new FileReader;s.readAsText(i),s.onload=async s=>{if(n.includes(".json")){ge(!0);const e=s.target.result;if(e)try{z=[],fe(null),ce(null),pe(null);let i=JSON.parse(e);const{suiteName:n}=i;let s=!0,r=!1;const{generatedSuiteNames:a}=K,{testCases:c}=i,u=[],p=[],x={},h=null===ie||void 0===ie?void 0:ie.ModuleValidate,{testNodeProps:v,validNavActions:m,validValidateActions:j}=null===h||void 0===h?void 0:h.executionDataRules;null===c||void 0===c||c.forEach((e,i)=>{var n;const{testNode:s}=e,{testCaseID:l,dependsOn:o,testCaseSteps:r}=s;l&&u.push(l),o&&p.push(o),x[l]=o;const a=[];let d=[];null===v||void 0===v||v.forEach(e=>{s[e]||"dependsOn"===e&&""===s[e]&&0===i||a.push(e),null===r||void 0===r||r.forEach(e=>{const t=Object.keys(e)[0];if(t===B.WH.VALIDATE||m.includes(t)){if(t===B.WH.VALIDATE){const i=Object.keys(e[t][0])[0];j.includes(i)||d.push(i)}}else d.push(t)})}),0!==(null===a||void 0===a?void 0:a.length)&&(l?t.push(`${a} missing in test case - [${l}]`):t.push(`${a} missing in ${Xe(i+1)} test case `)),d=[...new Set(d)],0!==(null===(n=d)||void 0===n?void 0:n.length)&&(l?t.push(`Unknown ${d} action in test case - [${l}]`):t.push(`Unknown ${d} action in ${Xe(i+1)} test case `))});const f=qe(x),A=p.filter(e=>!u.includes(e)),g=A.indexOf("");var l;if(g>-1&&A.splice(g,1),(null===A||void 0===A?void 0:A.length)>0&&t.push(`Unknown test case ids in dependsOn [${A}]`),(null===f||void 0===f?void 0:f.length)>0&&t.push(`Issue with test cases dependencies [${f}]`),a&&0!==a.length)null===K||void 0===K||null===(l=K.generatedSuiteNames)||void 0===l||l.forEach(e=>{n.includes(e)&&(r=!0)});else r=!0;if(r||t.push(`Suite [${n}] is not applicable for current project`),e.includes('"module"')){var o;const e=await(0,U.sY)(null===G||void 0===G||null===(o=G.company)||void 0===o?void 0:o._id,null===K||void 0===K?void 0:K._id);if(0===(null===e||void 0===e?void 0:e.length))t.push("No methods found for Project"),s=!1;else if(e){const n=null===e||void 0===e?void 0:e.map(e=>e.name),{testCases:l}=i,o=[];null===l||void 0===l||l.forEach(e=>{var i;const l=null===(i=e.testNode)||void 0===i?void 0:i.testCaseSteps;null===l||void 0===l||l.forEach(e=>{if(Object.keys(e).includes("module")){var t;const l=Object.keys(e.module);var i;if(!n.includes(null===e||void 0===e||null===(t=e.module[l[0]])||void 0===t?void 0:t.methodName))o.push(`${null===e||void 0===e||null===(i=e.module[l[0]])||void 0===i?void 0:i.methodName}`),s=!1}}),1===(null===o||void 0===o?void 0:o.length)?t.push(`[${o.toString()}] method is not found for Project`):(null===o||void 0===o?void 0:o.length)>=1&&t.push(`[${o.toString()}] methods are not found for Project`)})}}ae(i.suiteName);const y=await(0,F.fs)(),b=(null===te||void 0===te?void 0:te.find(e=>e.suiteName===i.suiteName))||(null===y||void 0===y?void 0:y.find(e=>e.suiteName===i.suiteName));be(i),"object"===typeof i&&"result"in i&&(i=i.result,be(i)),He(i),e.includes("$")&&s&&r?se(!0):e.includes("$")?se(!1):Ue(!1),b&&!d?(ke(!0),se(!1)):!b&&d&&(t.push("Suite name doesn't match"),se(!1)),(null===t||void 0===t?void 0:t.length)>0&&(ke(!1),se(!1)),me([...new Set(t)])}catch(r){Je(),console.log("err",r),he("You have uploaded Invalid JSON. Please try uploading valid JSON")}else Pe("Empty File Uploaded"),_e("Please upload valid Execution file"),Ue(!0),Fe(!0)}else if(n.includes(".xls")||n.includes(".xlsx")){const t=new FileReader;t.readAsText(e[0]),t.onload=async()=>{const e=await i.arrayBuffer(),t=h.LF(e,{type:"array"}),n=t.Sheets[t.SheetNames[0]],s=h.Wp.sheet_to_json(n);ae(s[0]["Suite Name"]);const l=s[0]["Suite Name"];te.find(e=>e.suiteName===l)&&!d&&ke(!0)},ge(!1);const n=new FormData;n.append("file",i);await(0,L.rI)(Z,n)?(he("The file could not be processed. Please download the template and try again"),me([]),oe(null),ae(null),ge(!0),(0,L.fD)(Z,null),Fe(!1),Ue(!0),z=[]):Ue(!1)}}}else he("Module type should be JSON or Excel")}}else{t[0].file.path.includes("xlsx")?he("For Automated execution JSON file is expected"):he("For Manual execution Excel file is expected")}}catch(i){console.log("err",i)}},[Z,K,He,d,te,Je,ie]),Ze=(0,n.useCallback)((e,t)=>{try{let i;if(0===t.length){const t=e[0];if(t){ce({...t,preview:URL.createObjectURL(t)});const n=t.name;if(console.log("fileName",n),pe(n),n.includes(".xls")||n.includes(".xlsx")){const s=new FileReader;s.readAsText(e[0]),s.onload=async()=>{const e=await t.arrayBuffer(),s=h.LF(e,{type:"array"}),l=s.Sheets[s.SheetNames[0]],o=h.Wp.sheet_to_json(l);if(o&&0!==(null===o||void 0===o?void 0:o.length)?(i=!0,Ue(!1)):(Pe("Empty File Uploaded"),_e("Please upload valid Test data file"),Ue(!0),Fe(!0)),i){const e=(e=>e[0]?"key"===Object.keys(e[0])[0]:null)(o);if(e){const e=(e=>{const t=[],i={};return e.forEach(e=>{const t=null===e||void 0===e?void 0:e.key,n=null===e||void 0===e?void 0:e.value;i[t]=n}),t.push(i),t})(o);fe({fileName:n,data:e})}else fe({fileName:n,data:o})}}}else he("Test Data File type should be JSON or Excel")}else pe(null)}else he("For Test Data upload Excel File is expected")}catch(i){console.log("err",i)}},[]),Ge=(e,t)=>{he(""),me([]);const i=document.createElement("input");i.type="file",i.accept=e,t===H.JSON&&(i.accept="application/json"),t!==H.TEST_DATA&&t!==H.MANUAL||(i.accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"),i.onchange=()=>{const e=Array.from(i.files);t!==H.JSON&&t!==H.MANUAL||Ye(e,[]),t===H.TEST_DATA&&Ze(e,[])},i.click()},Qe=()=>{Ne(!1)},Ke=async e=>{const{name:t,value:i}=e.target,n={...null===Te||void 0===Te?void 0:Te.testData};n[t]=i,Oe({index:null===Te||void 0===Te?void 0:Te.index,testData:n})},et=(0,x.Wx)({enableReinitialize:!0,initialValues:{name:(null===c||void 0===c?void 0:c.name)||"",description:(null===c||void 0===c?void 0:c.description)||"",status:(null===c||void 0===c?void 0:c.status)||!1,globalValue:(null===c||void 0===c?void 0:c.globalValue)||!1,users:(null===c||void 0===c?void 0:c.users)||[]},validationSchema:ze,onSubmit:async(e,t)=>{let{setSubmitting:i,setErrors:n}=t;try{(async()=>{var e;const t=[];var i;Ae&&(null===je||void 0===je||null===(i=je.data)||void 0===i||i.map(e=>(t.push(e),null)));const n={projectID:K._id,suiteName:Ae?null===ye||void 0===ye?void 0:ye.suiteName:ee.suiteName,businessProcess:Ae?null===ye||void 0===ye?void 0:ye.businessProcess:ee.businessProcess,suiteDescription:Ae?null===ye||void 0===ye?void 0:ye.suiteDescription:ee.suiteDescription,testNodes:Ae?null===ye||void 0===ye?void 0:ye.testCases:ee.testCases,testPlaceholders:Ae?t:[],createdBy:null===G||void 0===G?void 0:G._id,automationStatus:Ae,email:G.email,company:G.company._id};te.find(e=>e.suiteName===n.suiteName);let s=null;if(s=await(0,L.d9)(Z,n),null!==(e=s)&&void 0!==e&&e.errors){var l;const e=null===(l=s)||void 0===l?void 0:l.errors,t=[];null===e||void 0===e||e.forEach(e=>{const i=e.split("."),{testCases:n}=ee;try{var s,l;let o="";o=e.includes(".")?`${i[4]} validation failed for [${null===(s=n[i[1]])||void 0===s||null===(l=s.testNode)||void 0===l?void 0:l.testCaseID}]`:`${e} validation failed`,t.push(o)}catch(o){console.log("err",o)}}),me(t),Y("Module creation failed due to validations",{variant:"error"})}else Y(d?"Module changes saved":"Module created successfully",{variant:"success"}),Be(r.nB.module.allModules)})(),i(!1)}catch(s){console.error(s),i(!1),n(s)}}}),{handleSubmit:tt,isSubmitting:it}=et,nt=(0,n.useCallback)(e=>{if(e){let t;if("string"===typeof e?t=e:Object(e)&&null!==e?[t]=Object.values(e):t=e,t)if(Array.isArray(t))t.forEach(e=>{e&&nt(e)});else if("string"===typeof t)t.startsWith("$")&&z.push(t);else if(Object(t)&&null!==t){Object.values(t).filter(e=>e).forEach(e=>{e&&nt(e)})}}},[]);return(0,n.useEffect)(()=>{(async()=>{(0,L.fD)(Z,null),fe(null),(0,L.Ln)(Z)})()},[Z]),(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(x.QI,{value:et,children:(0,W.jsxs)(x.lV,{noValidate:!0,autoComplete:"off",onSubmit:tt,children:[(0,W.jsxs)(m.Ay,{container:!0,spacing:3,children:[(0,W.jsx)(m.Ay,{item:!0,xs:12,md:12,children:(0,W.jsx)(j.A,{sx:{p:3},children:(0,W.jsxs)(f.A,{spacing:3,children:[(0,W.jsxs)(f.A,{direction:"row",alignItems:"center",children:[(0,W.jsx)(A.A,{variant:"subtitle1",sx:{mt:.5},children:"Please select the type of module you wish to import :"}),(0,W.jsx)(g.A,{select:!0,size:"small",value:we,onChange:e=>{Se(e.target.value),(0,L.fD)(Z,null),oe(null),ae(null),ce(null),pe(null),he(""),me([]),"jsonBuilder"===e.target.value&&Ve()},SelectProps:{native:!0},FormHelperTextProps:{sx:{textAlign:"right",margin:0,mt:1}},sx:{p:"0 24px"},children:V.map(e=>(0,W.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,W.jsxs)(A.A,{variant:"subtitle2",sx:{color:"text.error"},children:[0===(null===ve||void 0===ve?void 0:ve.length)&&xe,(null===ve||void 0===ve?void 0:ve.length)>0&&(null===ve||void 0===ve?void 0:ve.map(e=>(0,W.jsx)("p",{children:e},e)))]}),"manual"===we&&(0,W.jsxs)(f.A,{spacing:2,sx:{width:1},children:[(0,W.jsx)(A.A,{variant:"overline",sx:{color:"text.secondary"},children:"Import Manual Module"}),(0,W.jsxs)(f.A,{direction:"row",sx:{width:1,mt:"5px !important"},children:[(0,W.jsx)(A.A,{variant:"subtitle2",sx:{color:"text?.primary"},children:"If you want to import your test cases in a spreadsheet :"}),(0,W.jsx)(A.A,{variant:"subtitle2",sx:{color:"text?.primary",paddingLeft:1},children:(0,W.jsx)("a",{href:$,download:"Sample-Template",target:"_blank",rel:"noreferrer",children:"Download this Template"})})]}),(0,W.jsx)(f.A,{spacing:2,children:(0,W.jsx)(A.A,{variant:"overline",sx:{color:"text.secondary"},children:"Test Cases File"})}),(0,W.jsx)(m.Ay,{item:!0,xs:12,md:4,children:(0,W.jsx)(M._H,{file:le,fileName:re,accept:q,onDrop:Ye,onReplace:e=>Ge(e,H.MANUAL),onDelete:Je})})]}),"automated"===we&&(0,W.jsxs)(f.A,{spacing:2,sx:{width:1},children:[(0,W.jsx)(A.A,{variant:"overline",sx:{color:"text.secondary"},children:"Import Automated Module"}),(0,W.jsxs)(m.Ay,{container:!0,spacing:1,children:[(0,W.jsxs)(m.Ay,{item:!0,xs:12,md:4,children:[(0,W.jsx)(f.A,{spacing:2,children:(0,W.jsx)(A.A,{variant:"overline",sx:{color:"text.secondary"},children:"Execution File"})}),(0,W.jsx)(M._H,{file:le,accept:J,fileName:re,onDrop:Ye,onReplace:e=>Ge(e,H.JSON),onDelete:Je})]}),ee&&ne&&(0,W.jsxs)(m.Ay,{item:!0,xs:12,md:4,children:[(0,W.jsx)(f.A,{spacing:2,children:(0,W.jsx)(A.A,{variant:"overline",sx:{color:"text.secondary"},children:"Test Data File"})}),(0,W.jsx)(M._H,{file:de,accept:q,fileName:ue,onDrop:Ze,onReplace:e=>Ge(e,H.TEST_DATA),onDelete:()=>{he(""),me([]),ce(null),pe(null),fe(null),Fe(!1),Ue(!0),z=[]}})]})]})]})]})})}),ee&&(null===ee||void 0===ee?void 0:ee.testCases.length)>0&&(0,W.jsx)(m.Ay,{item:!0,xs:12,md:12,children:(0,W.jsxs)(m.Ay,{container:!0,spacing:3,children:[(0,W.jsx)(m.Ay,{item:!0,xs:12,md:je?6:12,children:(0,W.jsxs)(j.A,{style:{boxShadow:"0 0 10px #919eab"},children:[(0,W.jsx)(y.A,{title:"Test Cases Preview",sx:{mb:2}}),(0,W.jsx)(_.A,{children:(0,W.jsx)(b.A,{sx:{minWidth:480,maxHeight:300},children:(0,W.jsxs)(w.A,{stickyHeader:!0,children:[(0,W.jsx)(S.A,{children:(0,W.jsxs)(C.A,{children:[(0,W.jsx)(k.A,{children:"TestCase Id"}),(0,W.jsx)(k.A,{children:"Title"}),(0,W.jsx)(k.A,{children:"Automated ?"})]})}),(0,W.jsx)(D.A,{children:null===ee||void 0===ee?void 0:ee.testCases.map(e=>{var t,i,n;return(0,W.jsxs)(C.A,{children:[(0,W.jsx)(k.A,{children:(0,W.jsx)(A.A,{variant:"subtitle2",children:(null===(i=e.testNode)||void 0===i?void 0:i.testCaseID)||e.testCaseID})}),(0,W.jsx)(k.A,{children:(null===(n=e.testNode)||void 0===n?void 0:n.testCaseTitle)||e.testCaseTitle}),(0,W.jsx)(k.A,{children:"automated"===we?"Yes":"No"})]},(null===(t=e.testNode)||void 0===t?void 0:t.testCaseID)||e.testCaseID)})})]})})})]})}),je&&(0,W.jsx)(m.Ay,{item:!0,xs:12,md:6,children:(0,W.jsxs)(j.A,{style:{boxShadow:"0 0 10px #919eab"},children:[(0,W.jsx)(y.A,{title:"Test Data Preview",sx:{mb:2}}),(0,W.jsxs)(_.A,{children:[1===(null===je||void 0===je||null===(t=je.data)||void 0===t?void 0:t.length)&&(0,W.jsx)(b.A,{sx:{minWidth:480,maxHeight:300},children:(0,W.jsx)(w.A,{children:(0,W.jsx)(D.A,{children:null===(i=Object.keys(null===je||void 0===je?void 0:je.data[0]))||void 0===i?void 0:i.map(e=>(0,W.jsx)(C.A,{children:(0,W.jsx)(k.A,{style:{padding:"5px 20px"},children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,W.jsx)("div",{style:{width:"50%",fontSize:"16px",fontWeight:"600",textTransform:"capitalize",wordBreak:"break-word",whiteSpace:"normal",overflowWrap:"anywhere"},children:e}),(0,W.jsx)("div",{children:(0,W.jsx)(g.A,{required:!0,type:"password"===e?"password":"text",sx:{width:"100%","& .MuiOutlinedInput-root":{"& > fieldset":{border:"none"}}},id:e,defaultValue:null===je||void 0===je?void 0:je.data[0][e]})})]})})},e))})})}),(null===je||void 0===je||null===(l=je.data)||void 0===l?void 0:l.length)>1&&(0,W.jsx)(b.A,{sx:{minWidth:480,maxHeight:300},children:(0,W.jsxs)(w.A,{stickyHeader:!0,children:[(0,W.jsx)(S.A,{children:(0,W.jsx)(C.A,{children:Object.keys(null===je||void 0===je?void 0:je.data[0]).map(e=>(0,W.jsx)(k.A,{children:e},e))})}),(0,W.jsx)(D.A,{children:null===je||void 0===je?void 0:je.data.map((e,t)=>(0,W.jsx)(C.A,{children:Object.keys(e).map(t=>(0,W.jsx)(k.A,{children:"password"===t?(0,W.jsx)(g.A,{required:!0,type:"password"===t?"password":"text",id:t,defaultValue:e[t],style:{height:"2rem"},inputProps:{readOnly:!0},sx:{"& fieldset":{border:"none"}}}):e[t]},t))},t))})]})})]})]})})]})})]}),"jsonBuilder"!==we&&(0,W.jsx)(N.A,{sx:{mt:3,display:"flex",justifyContent:"flex-end"},children:(0,W.jsx)(v.A,{type:"submit",variant:"contained",loading:it,disabled:Me,children:d?"Save Changes":"Save Module"})}),(0,W.jsxs)(T.A,{open:Ce,onClose:We,children:[(0,W.jsx)(I.A,{id:"simple-dialog-title",children:"Module Info"}),(0,W.jsx)(E.A,{children:(0,W.jsxs)(O.A,{id:"alert-dialog-slide-description",children:[(0,W.jsx)("br",{}),(0,W.jsx)("br",{}),"Module Name with ",(0,W.jsxs)("b",{children:["[",re,"]"]})," already exists!! The Module data will be replaced!!",(0,W.jsx)("br",{}),(0,W.jsx)("br",{}),"Do you want to continue?"]})}),(0,W.jsxs)(R.A,{children:[(0,W.jsx)(P.A,{onClick:()=>{We(),Je()},children:"Disagree"}),(0,W.jsx)(P.A,{onClick:()=>{We(),(()=>{const e=null===te||void 0===te?void 0:te.find(e=>e.suiteName===re);Be(r.nB.module.editById(null===e||void 0===e?void 0:e._id)),se(!0)})()},autoFocus:!0,children:"Agree"})]})]})]})}),(null===Te||void 0===Te?void 0:Te.testData)&&(0,W.jsxs)(T.A,{open:De,onClose:Qe,children:[(0,W.jsx)(I.A,{id:"edit-testdata-row",children:"Edit Test Data"}),(0,W.jsxs)(E.A,{children:[(0,W.jsx)(O.A,{id:"edit-testdata-row-description"}),(0,W.jsx)("form",{id:"save-test-data",onSubmit:e=>(e=>{e.preventDefault();const t=[...null===je||void 0===je?void 0:je.data];t[null===Ee||void 0===Ee?void 0:Ee.index]=null===Ee||void 0===Ee?void 0:Ee.testData,fe({...je,data:t})})(e),children:(0,W.jsx)(b.A,{sx:{minWidth:480,maxHeight:300},children:(0,W.jsx)(w.A,{children:(0,W.jsx)(D.A,{children:null===(a=Object.keys(null===Te||void 0===Te?void 0:Te.testData))||void 0===a?void 0:a.map(e=>(0,W.jsx)(C.A,{children:(0,W.jsx)(k.A,{style:{padding:"5px 20px"},children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,W.jsx)("div",{style:{width:"50%",fontSize:"16px",fontWeight:"600",textTransform:"capitalize"},children:e}),(0,W.jsx)("div",{children:(0,W.jsx)(g.A,{required:!0,type:"password"===e?"password":"text",sx:{width:"100%","& .MuiOutlinedInput-root":{"& > fieldset":{border:"none"}}},id:e,defaultValue:null===Te||void 0===Te?void 0:Te.testData[e],onChange:Ke,name:e})})]})})},e))})})})})]}),(0,W.jsxs)(R.A,{children:[(0,W.jsx)(P.A,{form:"save-test-data",variant:"contained",type:"submit",onClick:Qe,children:"save"}),(0,W.jsx)(P.A,{variant:"contained",onClick:Qe,children:"cancel"})]})]}),(0,W.jsxs)(T.A,{open:Le,onClose:()=>Fe(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,W.jsx)(I.A,{id:"alert-dialog-title",children:Re}),(0,W.jsx)(E.A,{children:(0,W.jsxs)(O.A,{id:"alert-dialog-description",children:[(0,W.jsx)("br",{}),$e]})}),(0,W.jsx)(R.A,{children:(0,W.jsx)(P.A,{onClick:()=>{Fe(!1)},children:"Ok"})})]})]})}var Y=i(31802);function Z(){const{themeStretch:e}=(0,a.A)(),t=(0,o.wA)(),{pathname:i}=(0,s.zy)(),{moduleId:u}=(0,s.g)(),{userList:p,appendUrl:x}=(0,o.d4)(e=>e.user),{moduleList:h}=(0,o.d4)(e=>e.module),v=i.includes("edit"),m=null===h||void 0===h?void 0:h.find(e=>e._id===u);return(0,n.useEffect)(()=>{t((0,L.fs)()),t((0,Y.aU)())},[t]),(0,W.jsx)(d.A,{title:"Test Ensure",children:(0,W.jsxs)(l.A,{maxWidth:!e&&"xl",children:[(0,W.jsx)(c.A,{heading:v?"Edit module":"Create a new Module",links:[{name:"All Modules",href:(e=>{let t=e;return x&&(t=`${e}?${x}`),t})(r.nB.module.allModules)},{name:v?null===m||void 0===m?void 0:m.suiteName:"New module"}],info:"To create a module, you must be an administrator, or your role must have the privileges"}),(0,W.jsx)(X,{isEdit:v,currentModule:m,userList:p})]})})}}}]);
//# sourceMappingURL=2022.9c765edc.chunk.js.map